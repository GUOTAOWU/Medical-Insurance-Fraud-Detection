# AIを活用した医療保険請求詐欺検知管理システム
# (AI-Powered Medical Insurance Fraud Detection Management System)

## 1. プロジェクトの概要 (Introduction)
本プロジェクトは、Python (Flask) をベースに構築されたWebアプリケーションであり、機械学習を活用して医療保険請求データにおける「正常」な請求と「不正（詐欺）」の疑いがある請求を自動的に識別・監査するシステムです。

膨大な医療保険請求データの中から、AIが不正請求のパターンを検知することで、監査担当者の業務負担を軽減し、審査プロセスの効率化と精度の向上を目的としています。データの取り込みからAIによる分析、そして最終的な審査管理までをワンストップで行える統合業務システムです。

## 2. ディレクトリ構造とファイル説明 (File Description)


本プロジェクトは、大きく分けて「システム実装用（コード1）」と「データ分析・モデル開発プロセス用（コード2）」の2つのディレクトリで構成されています。

### 📂 プロジェクト構成図

```text
Project_Root
│
├── 📂 コード1/code  (Webアプリケーション実装 - System Deployment)
│   │  本番環境で稼働するFlaskシステムのコード一式です。
│   │
│   ├── 📂 templates/             # フロントエンド画面のHTMLテンプレート
│   ├── 📄 app.db                 # SQLiteデータベース（ユーザー情報や監査ログの保存）
│   ├── 📄 app.py                 # メインアプリケーションコード（Flask起動、ルーティング）
│   ├── 📄 best_xgboost_model.pkl # 学習済みAIモデル（システムが予測に使用するもの）
│   ├── 📄 test.xlsx              # システム動作確認用のテストデータ（多量）
│   └── 📄 test1.xlsx             # システム動作確認用のテストデータ（少量）
│
└── 📂 コード2 (データサイエンス・開発プロセス - Development Workflow)
    │  モデル完成に至るまでの前処理、学習、実験の過程が含まれています。
    │
    ├── 📂 1 データ
    │      # プロジェクトの初期データ保存場所
    │
    ├── 📂 2 データ前処理、特徴量エンジニアリング (Preprocessing)
    │      ├── 📄 data-14-01.xlsx      # 初期（Raw）データ
    │      ├── 📄 processed_data.xlsx  # 一次クリーニング後のデータ
    │      ├── 📄 最终数据.xlsx         # 前処理完了後の最終データ（学習に使用）
    │      └── 📓 数据.ipynb            # 前処理ロジックを記述したJupyter Notebook
    │
    ├── 📂 3 機械学習 (Model Training)
    │      ├── 📓 model.ipynb          # モデル学習・比較・評価のコード
    │      ├── 📄 最终数据.xlsx         # 学習に使用したデータセット
    │      ├── 📄 best_xgboost_model.pkl      # 【採用】最高精度のXGBoostモデル
    │      ├── 📄 optimized_xgboost_model.pkl # チューニング済みXGBoostモデル
    │      ├── 📄 best_traditional_model.pkl  # 比較用モデル（RandomForest等）
    │      └── 📄 mlp_model.pkl               # 比較用モデル（多層パーセプトロン）
    │
    └── 📂 4 結果予測 (Prediction & Validation)
           ├── 📓 模型使用.ipynb            # 学習済みモデルを使用した予測テストのコード
           ├── 📄 测试数据.xlsx             # テスト用生データ
           ├── 📄 测试数据预处理结果.xlsx     # テストデータを前処理した結果
           └── 📄 best_xgboost_model.pkl    # 予測に使用するモデルファイル

## 3. データセット (Dataset)
本システムは、医療保険請求の詳細情報が含まれた **Excel形式 (.xlsx)** のデータを使用します。
データには、請求金額、医療機関情報、診断コード、患者情報などの属性が含まれており、これらをAIモデルの学習および予測の入力データとして利用します。

## 4. 使用手法・アルゴリズム (Methodology)
本システムでは、以下のデータサイエンスおよび機械学習の手法を採用しています。

### A. データ前処理 (Data Preprocessing)
* **クレンジング:** Excelデータの読み込み、欠損値の処理、不要な列の削除。
* **正規化:** 数値データのMin-Max Scaling。
* **エンコーディング:** カテゴリカルデータの数値化。

### B. 不均衡データの処理 (Handling Imbalanced Data)
詐欺データは正常データに比べて極端に少ないため、**SMOTE + Tomek Links** 法を用いてデータのバランスを調整し、モデルが詐欺パターンを適切に学習できるよう最適化しています。

### C. 機械学習モデル (Machine Learning Models)
以下のアルゴリズムを用いてモデルを訓練し、請求が「0: 正常」か「1: 詐欺」かを分類します。
* **XGBoost** (メインモデル)
* Random Forest (比較用など)
* MLP
* SVM

また、**特徴量分析**を行い、どの項目（金額や診断コードなど）が詐欺判定に強く寄与したかを可視化します。

## 5. 実施プロセスと機能 (Implementation & Workflow)
本システムはWebアプリケーションとして実装されており、以下の流れで業務を行います。

### 技術スタック
* **Backend:** Python, Flask, SQLAlchemy
* **Frontend:** HTML, Bootstrap 5
* **AI/Analysis:** Pandas, Scikit-learn, XGBoost, Imbalanced-learn
* **Database:** SQLite (開発環境)

### 具体的な業務フロー
1.  **ログイン (Login):**
    * 管理者がセキュアな環境（パスワードハッシュ化、CAPTCHA認証）でログインします。
2.  **データ入力 (Data Import):**
    * 新しい保険請求データをExcelファイルで一括インポートします。
    * システム内でデータのCRUD操作（作成・参照・更新・削除）も可能です。
3.  **AI監査実行 (AI Audit):**
    * 監査ページにて対象データを選択し、予測を実行します。
4.  **結果確認 (Result Verification):**
    * AIが「詐欺疑い」と判定した案件がカード形式で表示されます。
    * 詐欺グループと正常グループの統計的差異や、判定根拠を確認します。
5.  **対応・ステータス更新 (Action):**
    * 担当者が最終判断を行い、システム上でステータス（承認/拒絶）を更新します。

## 6. 結論 (Conclusion)
本システムの実装により、従来の手作業による監査に比べ、不正請求の発見率向上と審査時間の短縮が期待できます。不均衡データへの適切な対処とXGBoostなどの高性能モデルの組み合わせにより、高精度な予測を実現しました。単なる予測モデルに留まらず、実業務で運用可能な管理画面を備えた包括的なソリューションとなっています。
